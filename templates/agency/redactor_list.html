{% extends "layouts/base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <div class="container-fluid py-4 mt-6">
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header pb-0">
            <div class="d-flex justify-content-between align-items-center">
              <h4 class="mb-0">Authors</h4>
              <a class="btn btn-primary btn-sm mb-0" href="{% url 'agency:redactor-create' %}">
                <i class="fas fa-plus me-2"></i>Create Author
              </a>
            </div>
          </div>
          <div class="card-body">
            <div class="row mb-4">
              <div class="col-md-6">
                <form action="" method="get" class="d-flex align-items-stretch" style="max-width: 400px; height: 45px;">
                  <input
                      type="text"
                      name="query"
                      class="form-control h-100 border-end-0"
                      placeholder="Search authors..."
                      value="{{ request.GET.query }}"
                      style="border-radius: 8px 0 0 8px; border: 1px solid #d2d6da; padding-left: 15px;">
                  <button class="btn bg-gradient-primary h-100 border-start-0"
                          type="submit"
                          style="border-radius: 0 8px 8px 0; width: 50px; padding: 0; border: 1px solid #d2d6da; border-left: none;">
                    üîç
                  </button>
                </form>
              </div>
            </div>
          
            {% if redactor_list %}
              <div class="table-responsive">
                <table class="table align-items-center mb-0">
                  <thead>
                  <tr>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Author</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Username</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Experience</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Newspapers</th>
                    <th class="text-secondary opacity-7"></th>
                  </tr>
                  </thead>
                  <tbody>
                  {% for redactor in redactor_list %}
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <div
                                class="icon icon-shape icon-sm bg-gradient-primary shadow text-center border-radius-md">
                              <i class="fas fa-user text-white opacity-10"></i>
                            </div>
                          </div>
                          <div class="d-flex flex-column justify-content-center ms-4">
                            <h6 class="mb-0 text-sm">{{ redactor.first_name }} {{ redactor.last_name }}</h6>
                            <p class="text-xs text-secondary mb-0">{{ redactor.email|default:"No email" }}</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-sm font-weight-bold mb-0">{{ redactor.username }}</p>
                      </td>
                      <td>
                        <span class="badge badge-sm bg-gradient-info">
                          {{ redactor.years_of_experience }} year{{ redactor.years_of_experience|pluralize }}
                        </span>
                      </td>
                      <td>
                        <span class="badge badge-sm bg-gradient-success">
                          {{ redactor.newspapers.count }}
                        </span>
                      </td>
                      <td class="align-middle">
                        <div class="d-flex gap-2">
                          <a class="btn btn-outline-secondary btn-sm"
                             href="{% url 'agency:redactor-update' pk=redactor.id %}">
                            <i class="fas fa-edit me-1"></i>Update
                          </a>
                          <a class="btn btn-outline-danger btn-sm"
                             href="{% url 'agency:redactor-delete' pk=redactor.id %}">
                            <i class="fas fa-trash me-1"></i>Delete
                          </a>
                        </div>
                      </td>
                    </tr>
                  {% endfor %}
                  </tbody>
                </table>
              </div>
            {% else %}
              <div class="text-center py-4">
                <i class="fas fa-users fa-3x text-muted mb-3"></i>
                <h5 class="text-muted">No authors found</h5>
                <p class="text-muted">Create your first author to get started</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}